@let e = event();
<article class="group relative flex flex-col bg-white dark:bg-slate-800 rounded-2xl shadow-sm hover:shadow-lg transition-all duration-300 overflow-hidden h-full border border-gray-100 dark:border-gray-700">
  <div class="relative h-48 overflow-hidden">
    <div class="absolute top-3 left-3 z-10 flex gap-2">
      @if (e.rating != null && e.reviewCount != null) {
        <span class="px-3 py-1 bg-white/90 dark:bg-black/80 backdrop-blur text-xs font-bold text-slate-900 dark:text-white rounded-full shadow-sm">
          <span class="text-primary">★</span> {{ e.rating }} ({{ e.reviewCount }})
        </span>
      }
    </div>
    @if (e.badge && e.badge.kind !== 'none') {
      <div class="absolute top-3 right-3 z-10">
        <span
          class="px-3 py-1 text-white text-xs font-bold rounded-full shadow-lg flex items-center gap-1"
          [class.bg-purple-600]="e.badge.kind === 'vip'"
          [class.shadow-purple-600/30]="e.badge.kind === 'vip'"
          [class.bg-orange-500]="e.badge.kind === 'low_stock'"
          [class.shadow-orange-500/30]="e.badge.kind === 'low_stock'">
          @if (e.badge.icon) {
            <span class="material-symbols-outlined text-[14px]">{{ e.badge.icon }}</span>
          }
          {{ e.badge.label }}
        </span>
      </div>
    }
    <button
      type="button"
      class="absolute bottom-3 right-3 z-10 p-2 bg-white/20 backdrop-blur hover:bg-white text-white hover:text-red-500 rounded-full transition-colors"
      (click)="onFavorite($event, e)"
      [attr.aria-label]="'Ajouter aux favoris ' + e.title">
      <span class="material-symbols-outlined text-lg">favorite</span>
    </button>
    <img
      [src]="e.imageUrl"
      [alt]="e.imageAlt ?? e.title"
      class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"
    />
    <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-60"></div>
  </div>
  <div class="flex flex-col flex-1 p-5 gap-3">
    <div class="flex-1">
      <h3 class="text-lg font-bold text-slate-900 dark:text-white leading-tight group-hover:text-primary transition-colors line-clamp-2">{{ e.title }}</h3>
      <div class="flex flex-col gap-2 mt-3">
        <div class="flex items-center gap-2 text-slate-500 dark:text-gray-400 text-sm">
          <span class="material-symbols-outlined text-[18px] text-primary">calendar_month</span>
          <span class="font-medium">{{ e.dateLabel }}</span>
        </div>
        <div class="flex items-center gap-2 text-slate-500 dark:text-gray-400 text-sm">
          <span class="material-symbols-outlined text-[18px] text-primary">location_on</span>
          <span class="truncate">{{ e.location }}</span>
        </div>
      </div>
    </div>
    <div class="flex flex-col flex-1"></div>
    <div class="flex flex-end justify-between mt-2 pt-4 border-t border-gray-100 dark:border-gray-700">
      <div class="flex flex-col">
        <span class="text-xs text-slate-500 dark:text-gray-500">À partir de</span>
        <span class="text-lg font-bold text-slate-900 dark:text-white">{{ e.priceFrom | number:'1.2-2' }} {{ e.priceCurrency }}</span>
      </div>
      <a
        [routerLink]="['/client/events', e.id]"
        class="h-9 px-4 bg-primary hover:bg-primary-dark text-white text-sm font-bold rounded-full transition-colors shadow-lg flex items-center gap-1 inline-flex items-center justify-center">
        Voir détails
      </a>
    </div>
  </div>
</article>
